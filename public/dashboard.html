<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hallmarkmovies & Mysteries</title>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<style>
body {
background-color: #1a1a40;
color: #f0f0f0;
}

.navbar {
background-color: #008080;
}

.navbar-brand, .nav-link {
color: #f0f0f0 !important;
}

.container h2, .container h1 {
color: #ffffff;
margin-bottom: 20px;
}

.marquee {
width: 100%;
overflow: hidden;
white-space: nowrap;
box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}

.marquee-content {
display: inline-block;
padding-left: 100%;
animation: marquee 30s linear infinite;
}

@keyframes marquee {
0% {
transform: translate(0, 0);
}
100% {
transform: translate(-100%, 0);
}
}

.nav-tabs .nav-link {
color: #ffffff;
background-color: #333366;
border: none;
}

.nav-tabs .nav-link.active {
background-color: #005050;
}

.table {
background-color: #2c2c54;
color: #f0f0f0;
}

.table th, .table td {
border-top: none;
}

.form-control, .form-control-file {
background-color: #333366;
color: #ffffff;
border: 1px solid #666699;
}

.btn-primary {
background-color: #005050;
border: none;
}

.btn-outline-secondary {
border-color: #666699;
color: #f0f0f0;
}

.btn-outline-secondary:hover {
background-color: #666699;
color: #ffffff;
}
</style>
</head>
<body>
<nav class="navbar navbar-expand-lg">
<a class="navbar-brand" href="#">JPMorganreels</a>
<div class="collapse navbar-collapse" id="navbarNav">
<ul class="navbar-nav ml-auto">
<li class="nav-item"><a class="nav-link" href="index.html">Logout</a></li>
</ul>
</div>
</nav>

<div class="container my-4">
<h2 class="text-center">Cryptocurrency Prices</h2>
<div class="marquee">
<div class="marquee-content" id="cryptoMarquee"></div>
</div>
</div>

<div class="container mt-4">
<h1>User Dashboard</h1>
<div class="mb-4">
<h4>Your Profile</h4>
<p><strong>Name:</strong> <span id="userName"></span></p>
<p><strong>Email:</strong> <span id="userEmail"></span></p>
<p><strong>Balance:</strong> $<span id="balance"></span> (<span id="balanceWords"></span>)</p>
<p><strong>Total Profits:</strong> $<span id="profits"></span> (<span id="profitsWords"></span>)</p>
</div>

<ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
<li class="nav-item">
<a class="nav-link active" id="deposit-tab" data-toggle="tab" href="#deposit" role="tab" aria-controls="deposit" aria-selected="true">Deposit</a>
</li>
<li class="nav-item">
<a class="nav-link" id="withdraw-tab" data-toggle="tab" href="#withdraw" role="tab" aria-controls="withdraw" aria-selected="false">Withdraw</a>
</li>
<li class="nav-item">
<a class="nav-link" id="transactions-tab" data-toggle="tab" href="#transactions" role="tab" aria-controls="transactions" aria-selected="false">Transaction History</a>
</li>
</ul>

<div class="tab-content" id="dashboardTabContent">
<div class="tab-pane fade show active" id="deposit" role="tabpanel" aria-labelledby="deposit-tab">
<h4>Your Deposit History</h4>
<table class="table table-bordered">
<thead>
<tr>
<th>Amount</th>
<th>Status</th>
<th>Approved At</th>
<th>Proof of Payment</th>
</tr>
</thead>
<tbody id="depositHistory"></tbody>
</table>
<h3 class="fw-bolder">Note:</h3>
<p style="font-weight: 800;">Please contact admin via the live chat for more details on the payment method before proceeding to make deposit</p>
<h4>Deposit Money</h4>
<form id="depositForm">
<div class="form-group">
<label for="plan">Select Investment Plan</label>
<select class="form-control" id="plan" required>
<option value="" disabled selected>Select a plan</option>
<option value="Plan A">Basic - 10% Return</option>
<option value="Plan B">Premium - 15% Return</option>
<option value="Plan C">Silver - 20% Return</option>
</select>
</div>
<div class="form-group">
<label for="walletAddress">Select Wallet Address</label>
<select class="form-control" id="walletAddress" required>
<option value="" disabled selected>Select payment method</option>
<option value="wallet_address_1">Gift Card</option>
<option value="wallet_address_2">Bitcoin</option>
<option value="wallet_address_3">Wire Transfer</option>
<option value="wallet_address_4">Money Order</option>
<option value="wallet_address_5">Check</option>
</select>
<button type="button" class="btn btn-outline-secondary mt-2" onclick="copyWalletAddress()">Copy Address</button>
</div>
<div class="form-group">
<label for="amount">Amount</label>
<input type="number" class="form-control" id="amount" required>
</div>
<div class="form-group">
<label for="proof">Upload Proof of Payment</label>
<input type="file" class="form-control-file" id="proof" name="proofOfPayment" required>
</div>
<button type="submit" class="btn btn-primary">Submit Deposit</button>
</form>
</div>

<div class="tab-pane fade" id="withdraw" role="tabpanel" aria-labelledby="withdraw-tab">
<h4>Withdraw Money</h4>
<form id="withdrawForm">
<div class="form-group">
<label for="withdrawAmount">Amount to Withdraw</label>
<input type="number" class="form-control" id="withdrawAmount" required>
</div>
<div class="form-group">
<label for="withdrawAddress">Wallet Address</label>
<input type="text" class="form-control" id="withdrawAddress" required>
</div>
<button type="submit" class="btn btn-primary">Request Withdrawal</button>
</form>
<h4>Your Withdrawal History</h4>
<table class="table table-bordered" id="withdrawalHistoryTable">
<thead>
<tr>
<th>Amount</th>
<th>Status</th>
<th>Date</th>
</tr>
</thead>
<tbody id="withdrawalHistory"></tbody>
</table>
</div>

<div class="tab-pane fade" id="transactions" role="tabpanel" aria-labelledby="transactions-tab">
<h4>Your Transactions</h4>
<table class="table table-bordered">
<thead>
<tr>
<th>Amount</th>
<th>Type</th>
<th>Date</th>
<th>Status</th>
</tr>
</thead>
<tbody id="transactionHistory"></tbody>
</table>
</div>
</div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
async function fetchUserData() {
const token = localStorage.getItem('token');
if (!token) {
alert("User not authenticated, please login again.");
window.location.href = '/login.html';
return;
}
const response = await fetch('http://localhost:5000/api/users/me', {
headers: { 'Authorization': `Bearer ${token}` },
});
if (response.ok) {
const user = await response.json();
document.getElementById('userName').textContent = user.name;
document.getElementById('userEmail').textContent = user.email;
document.getElementById('balance').textContent = user.balance.toFixed(2);
document.getElementById('profits').textContent = user.profits.toFixed(2);

// Convert numbers to words
document.getElementById('balanceWords').textContent = numberToWords(user.balance);
document.getElementById('profitsWords').textContent = numberToWords(user.profits);

if (user.profits > previousProfit) {
alert(`Your profits have increased! New profit: $${user.profits.toFixed(2)}`);
}
previousProfit = user.profits;
} else if (response.status === 403) {
alert("Forbidden: Invalid token or session expired.");
localStorage.removeItem('token');
window.location.href = '/login.html';
} else {
alert('Failed to fetch user data');
}
}

function numberToWords(amount) {
const units = ["Zero", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine"];
const tens = ["", "", "Twenty", "Thirty", "Forty", "Fifty", "Sixty", "Seventy", "Eighty", "Ninety"];
const teens = ["Ten", "Eleven", "Twelve", "Thirteen", "Fourteen", "Fifteen", "Sixteen", "Seventeen", "Eighteen", "Nineteen"];

function convertToWords(n) {
if (n < 10) return units[n];
else if (n < 20) return teens[n - 10];
else if (n < 100) return tens[Math.floor(n / 10)] + (n % 10 !== 0 ? "-" + units[n % 10] : "");
else if (n < 1000) return units[Math.floor(n / 100)] + " Hundred" + (n % 100 !== 0 ? " and " + convertToWords(n % 100) : "");
else if (n < 1000000) return convertToWords(Math.floor(n / 1000)) + " Thousand" + (n % 1000 !== 0 ? ", " + convertToWords(n % 1000) : "");
else return "Amount too large";
}

return convertToWords(parseInt(amount)) + " Dollars";
}

fetchUserData();
</script>

</body>
</html>